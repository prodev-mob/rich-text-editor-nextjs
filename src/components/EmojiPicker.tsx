import * as Popover from '@radix-ui/react-popover';
import { FaSmile } from 'react-icons/fa';
import { Editor, Transforms } from 'slate';
import { useState } from 'react';

// A large set of emojis
const EMOJIS = Array.from(new Set([
  '😀','😃','😄','😁','😆','😅','😂','🤣','😊','😇','🙂','🙃','😉','😌','😍','🥰','😘','😗','😙','😚',
  '😋','😛','😝','😜','🤪','🤨','🧐','🤓','😎','🥳','🤩','😏','😒','😞','😔','😟','😕','🙁','☹️','😣',
  '😖','😫','😩','🥺','😢','😭','😤','😠','😡','🤬','🤯','😳','🥵','🥶','😱','😨','😰','😥','😓','🤗',
  '🤔','🤭','🤫','🤥','😶','😐','😑','😬','🙄','😯','😦','😧','😮','😲','🥱','😴','🤤','😪','😵','🤐',
  '🥴','🤢','🤮','🤧','😷','🤒','🤕','🤑','🤠','😈','👿','👹','👺','🤡','💩','👻','💀','☠️','👽','👾',
  '🤖','🎃','😺','😸','😹','😻','😼','😽','🙀','😿','😾','👶','🧒','👦','👧','🧑','👱‍♂️','👱‍♀️','👨','👩',
  '🧔','👴','👵','👨‍⚕️','👩‍⚕️','👨‍🎓','👩‍🎓','👨‍🏫','👩‍🏫','👨‍⚖️','👩‍⚖️','👮‍♂️','👮‍♀️','🕵️‍♂️','🕵️‍♀️','💂‍♂️','💂‍♀️','🥷','👷‍♂️','👷‍♀️',
  '🤴','👸','👳‍♂️','👳‍♀️','👲','🧕','🤵','👰','🤰','🤱','👼','🎅','🤶','🦸‍♂️','🦸‍♀️','🦹‍♂️','🦹‍♀️','🧙‍♂️','🧙‍♀️','🧚‍♂️',
  '🧚‍♀️','🧛‍♂️','🧛‍♀️','🧜‍♂️','🧜‍♀️','🧝‍♂️','🧝‍♀️','🧞‍♂️','🧞‍♀️','🧟‍♂️','🧟‍♀️','💆‍♂️','💆‍♀️','💇‍♂️','💇‍♀️','🚶‍♂️','🚶‍♀️','🏃‍♂️','🏃‍♀️','💃',
  '🕺','🧗‍♂️','🧗‍♀️','🏄‍♂️','🏄‍♀️','🏊‍♂️','🏊‍♀️','🤽‍♂️','🤽‍♀️','🚴‍♂️','🚴‍♀️','🚵‍♂️','🚵‍♀️','🤹‍♂️','🤹‍♀️','🛀','🛌','🧘‍♂️','🧘‍♀️','🦽',
  '🦼','🛹','🛷','🥌','🎯','🏹','🎣','🤿','🥊','🥋','🎽','⛸️','🎿','⛷️','🏂','🏋️‍♂️','🏋️‍♀️','🤺','🤼‍♂️',
  '🤼‍♀️','🤸‍♂️','🤸‍♀️','🤾‍♂️','🤾‍♀️','🤹','🧗','🧘','🏇','🧖‍♂️','🧖‍♀️','🛶','🚣‍♂️','🚣‍♀️','🏎️','🏍️','🛵','🚲','🛴','🚨',
  '❤️','💛','💚','💙','💜','🖤','🤍','🤎','💔','❣️','💕','💞','💓','💗','💖','💘','💝','💟','☮️','✝️',
  '☪️','🕉️','☸️','✡️','🔯','☯️','🕎','☦️','🛐','⛎','♈','♉','♊','♋','♌','♍','♎','♏','♐','♑','♒','♓',
  '🌞','🌝','🌛','🌜','🌚','🌕','🌖','🌗','🌘','🌑','🌒','🌓','🌔','🌙','🌎','🌍','🌏','💫','⭐','🌟','✨','⚡','🔥',
  '💥','☄️','🌪️','🌈','☀️','🌤️','⛅','🌥️','🌦️','🌧️','⛈️','🌩️','🌨️','❄️','☃️','⛄','🌬️','💨','💧','💦',
  '🌊','🌫️','🍏','🍎','🍐','🍊','🍋','🍌','🍉','🍇','🍓','🫐','🍈','🍒','🍑','🥭','🍍','🥥','🥝','🍅','🍆','🥑','🥦','🥬','🥒','🌶️','🫑','🌽','🥕','🫒','🧄','🧅','🥔','🍠','🥐','🥯','🍞','🥖','🥨','🧀','🥚','🍳','🧈','🥞','🧇','🥓','🥩','🍗','🍖','🦴','🌭','🍔','🍟','🍕','🥪','🥙','🌮','🌯','🫔','🥗','🥘','🍲','🫕','🥫','🍝','🍜','🍛','🍣','🍱','🥟','🦪','🍤','🍙','🍚','🍘','🍥','🥠','🥮','🍢','🍡','🍧','🍨','🍦','🥧','🧁','🍰','🎂','🍮','🍭','🍬','🍫','🍿','🧂',
]));


interface EmojiPickerProps {
  editor: Editor;
}

const EmojiPicker = ({ editor }: EmojiPickerProps) => {
  const [open, setOpen] = useState(false);

  const handleEmojiSelect = (emoji: string) => {
    Transforms.insertText(editor, emoji);
    setOpen(false);
  };

  return (
    <Popover.Root open={open} onOpenChange={setOpen}>
      <Popover.Trigger asChild>
        <button className="p-2 hover:bg-gray-100 rounded cursor-pointer" title="Insert Emoji">
          <FaSmile className="w-4 h-4" />
        </button>
      </Popover.Trigger>
      <Popover.Content className="bg-white p-2 rounded-lg shadow-lg grid grid-cols-5 gap-2 max-h-48 overflow-y-auto">
        {EMOJIS.map((emoji) => (
          <button
            key={emoji}
            className="text-xl hover:bg-gray-100 rounded p-1 cursor-pointer"
            onClick={() => handleEmojiSelect(emoji)}
          >
            {emoji}
          </button>
        ))}
      </Popover.Content>
    </Popover.Root>
  );
};

export default EmojiPicker;
